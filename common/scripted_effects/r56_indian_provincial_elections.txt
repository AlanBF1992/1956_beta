 
 ####################################
 #  INC - Indian National Congress  #
 #     UP/UPA - Unionist Party      #
 # IFB/ILP Independent Labour Party #
 ####################################
raj_lin_ai_chosenstate = {
	if = {
		limit = {
			is_ai = yes
		}
		random_list = {
			20 = {
				set_variable = { ChosenState = 1 }
			}
			30 = {
				set_variable = { ChosenState = 2 }
			}
			30 = {
				set_variable = { ChosenState = 3 }
			}
			30 = {
				set_variable = { ChosenState = 4 }
			}
		}
	}
}
raj_monthly_election_lin = {
	randomize_temp_variable = {
		var = temp_inc_add
		distribution = uniform
		min = 0  # optional
		max = 3 # required if min is specified
	}
	add_to_variable = {
		inc_v = temp_inc_add
	}
	randomize_temp_variable = {
		var = temp_upa_add
		distribution = uniform
		min = 0  # optional
		max = 3 # required if min is specified
	}
	add_to_variable = {
		upa_v = temp_upa_add
	}
	randomize_temp_variable = {
		var = temp_pak_add
		distribution = uniform
		min = 0  # optional
		max = 3 # required if min is specified
	}
	add_to_variable = {
		pak_v = temp_pak_add
	}
	raj_lin_calculate = yes

}
raj_lin_calculate = {
	clr_state_flag = inc_lead
	clr_state_flag = upa_lead
	clr_state_flag = pak_lead
	set_variable = {
		sum_v = inc_v
	}
	add_to_variable = {
		sum_v = pak_v
	}
	add_to_variable = {
		sum_v = upa_v
	}
	
	set_variable = {
		inc_o = inc_v
	}
	divide_variable = {
		inc_o = sum_v
	}
	multiply_variable = {
		inc_o = 100
	}
			
	set_variable = {
		pak_o = pak_v
	}
	divide_variable = {
		pak_o = sum_v
	}
	multiply_variable = {
		pak_o = 100
	}
	
	set_variable = {
		upa_o = upa_v
	}
	divide_variable = {
		upa_o = sum_v
	}
	multiply_variable = {
		upa_o = 100
	}
	if = {
		limit = {	#Has +1 Lead
			check_variable = {
				pak_o > upa_o
			}
			check_variable = {
				pak_o > inc_o
			}
		}
		set_state_flag = pak_lead
	}
	else_if = {
		limit = {	#Has +1 Lead
			check_variable = {
				upa_o > pak_o
			}
			check_variable = {
				upa_o > inc_o
			}
		}
		set_state_flag = upa_lead
	}
	else_if = {
		limit = {	#Has +1 Lead
			check_variable = {
				inc_o > upa_o
			}
			check_variable = {
				inc_o > pak_o
			}
		}
		set_state_flag = inc_lead
	}
}
RAJ_allocate_seats = {
	#100/temp_sum gives multiplier to percentage
	if = {	#INC AIML divide up seats
		limit = {
			check_variable = { upa_o < inc_o }
			check_variable = { upa_o < pak_o }
		}
		set_variable = { upa_o = 0 }
		
		set_temp_variable = { temp_sum = inc_o }	
		add_to_temp_variable = { temp_sum = pak_o }
		set_temp_variable = { parts = 100 }
		divide_temp_variable = { parts = temp_sum }
		
		multiply_variable = { inc_o = parts }
		multiply_variable = { pak_o = parts }

	}
	else_if = {	#AIML UPA divide up seats
		limit = {
			check_variable = { inc_o < upa_o }
			check_variable = { inc_o < pak_o }
		}
		set_variable = { inc_o = 0 }
		set_temp_variable = { temp_sum = upa_o }	
		add_to_temp_variable = { temp_sum = pak_o }
		set_temp_variable = { parts = 100 }
		divide_temp_variable = { parts = temp_sum }
		
		multiply_variable = { upa_o = parts }
		multiply_variable = { pak_o = parts }
	}
	else_if = {	#INC UPA divide up seats
		limit = {
			check_variable = { pak_o < upa_o }
			check_variable = { pak_o < inc_o }
		}
		set_variable = { pak_o = 0 }
		set_temp_variable = { temp_sum = upa_o }	
		add_to_temp_variable = { temp_sum = inc_o }	
		set_temp_variable = { parts = 100 }
		divide_temp_variable = { parts = temp_sum }
		
		multiply_variable = { upa_o = parts }
		multiply_variable = { inc_o = parts }
	}
		
	divide_variable = { inc_o = 100 }
	divide_variable = { pak_o = 100 }
	divide_variable = { upa_o = 100 }
	
	set_variable = { council_of_state_seats_inc = council_of_state_seats }
	set_variable = { council_of_state_seats_pak = council_of_state_seats }
	set_variable = { council_of_state_seats_upa = council_of_state_seats }
	
	multiply_variable = { council_of_state_seats_inc = inc_o }
	multiply_variable = { council_of_state_seats_pak = pak_o }
	multiply_variable = { council_of_state_seats_upa = upa_o }
	
	round_variable = council_of_state_seats_inc	#Needs testing for rounding errors (151 seats)
	round_variable = council_of_state_seats_pak
	round_variable = council_of_state_seats_upa
	
	RAJ = { 
		add_to_variable = { national_seats_inc = PREV.council_of_state_seats_inc }
		add_to_variable = { national_seats_pak = PREV.council_of_state_seats_pak }
		add_to_variable = { national_seats_upa = PREV.council_of_state_seats_upa }
	}
}
RAJ_Free_India_init = {	#Scrapped for now
	random_state = {
		limit = {
			is_controlled_by = JAP
			is_core_of = RAJ
			is_owned_by = RAJ
		}
		RAJ = {
			set_variable = { AH_capital = PREV }
		}
	}
	start_civil_war = {
		ruling_party = neutrality
		ideology = fascism
		size = 0.15
		only_own_territory = yes
		capital = var:AH_capital
		states = { 
			var:AH_capital 
		}
	}
	random_country_with_original_tag = {
		original_tag_to_check = RAJ
		limit = {
			has_government = fascism
		}
		save_global_event_target_as = AH_Scope
		RAJ_create_INA_generals = yes
		set_cosmetic_tag = RAJ_AH
		retire_ideology_leader = neutrality
	}
	JAP = {
		every_controlled_state = {
			limit = {
				is_core_of = RAJ
				is_owned_by = RAJ
			}
			event_target:AH_Scope = { set_state_controller = PREV }
		}
	}
}
RAJ_create_INA_generals = {
	
	create_corps_commander = {
		name = "Gulzara Singh"
		picture = "r56_portrait_RAJ_gulzara_singh.dds"
		traits = { artillerist }
		skill = 2
		attack_skill = 3
		defense_skill = 2
		planning_skill = 3
		logistics_skill = 1
	}

	create_corps_commander = {
		name = "Shah Nawaz Khan"
		picture = "r56_portrait_RAJ_Shah_Nawaz.dds"
		traits = { politically_connected }
		skill = 2
		attack_skill = 3
		defense_skill = 2
		planning_skill = 3
		logistics_skill = 1
	}

	create_corps_commander = {
		name = "Lakshmi Sahgal"
		picture = "r56_portrait_RAJ_Lakshmi_Sahgal.dds"
		traits = { infantry_officer }
		skill = 3
		attack_skill = 2
		defense_skill = 4
		planning_skill = 2
		logistics_skill = 1
	}
	
}
RAJ_Linlithgows_Act_init = {
	set_variable = { national_support_pak = national_seats_pak }
	set_variable = { national_support_inc = national_seats_inc }
	
	multiply_variable = { approx_muslim_support = opposition_goodwill }
	multiply_variable = { approx_hindu_support = opposition_goodwill }

	multiply_variable = { national_support_pak = approx_muslim_support }
	multiply_variable = { national_support_inc = approx_hindu_support }
	
	round_variable = national_support_pak
	round_variable = national_support_inc
}
raj_ah_random_list = {
	random_list = {
		10 = {	
			add_popularity = {
				ideology = neutrality
				popularity = -0.07
			}
			add_stability = -0.07
		}
		20 = {	
			add_popularity = {
				ideology = neutrality
				popularity = -0.05
			}
			add_stability = -0.05
		}
		40 = {	
			add_popularity = {
				ideology = neutrality
				popularity = -0.03
			}
			add_stability = -0.03
		}
		30 = {	
			add_popularity = {
				ideology = neutrality
				popularity = -0.015
			}
			add_stability = -0.015
		}
	}
}
raj_calculate_election = {
	hidden_effect = {
		set_variable = { electoral_provinces = 0 }
		every_owned_state = {
			limit = { 
				Election_Enable_State = yes
				NOT = {
					state = 445
					state = 442
					state = 440
				} 
			}
			RAJ = { add_to_variable = { electoral_provinces = 1 } }
		}
		RAJ = {
			set_variable = {
				inc_control = 0
			}
			every_owned_state = {
				limit = { INC_Majority = yes }
				RAJ = {add_to_variable = { inc_control = 1 }}
			}
			divide_variable = { inc_control = electoral_provinces }
			multiply_variable = { inc_control = 100 }
		}
		RAJ = {
			set_variable = {
				upa_control = 0
			}
			every_owned_state = {
				limit = { UPA_Majority = yes }
				RAJ = {add_to_variable = { upa_control = 1 }}
			}
			divide_variable = { upa_control = electoral_provinces }
			multiply_variable = { upa_control = 100 }
		}
		RAJ = {
			set_variable = {
				ifb_control = 0
			}
			every_owned_state = {
				limit = { IFB_Majority = yes }
				RAJ = {add_to_variable = { ifb_control = 1 }}
			}
			divide_variable = { ifb_control = electoral_provinces }
			multiply_variable = { ifb_control = 100 }
		}
		RAJ = {
			set_variable = { temp1 = inc_control }
			add_to_variable = { temp1 = upa_control }
			add_to_variable = { temp1 = ifb_control }
			set_variable = {
				neutral_control = 100
			}
			subtract_from_variable = { neutral_control = temp1 }
			
		}
	}
}
raj_decrease_influence_by_1 = { 
	if = { limit = { check_variable = { inc > 0 } } add_to_variable = { inc = -1 } }
	if = { limit = { check_variable = { ifb > 0 } } add_to_variable = { ifb = -1 } }
	if = { limit = { check_variable = { upa > 0 } } add_to_variable = { upa = -1 } }
	if = { limit = { check_variable = { neutral > 0 } } add_to_variable = { neutral = -1 } }
	raj_calculate_election = yes
}
raj_increase_selected_influence_by_1 = {
	if = { limit = { RAJ = { has_country_flag = inc_support } } add_to_variable = { inc = 1 } custom_effect_tooltip = raj_inc_1 }
	if = { limit = { RAJ = { has_country_flag = ifb_support } } add_to_variable = { ifb = 1 } custom_effect_tooltip = raj_ifb_1 }
	if = { limit = { RAJ = { has_country_flag = upa_support } } add_to_variable = { upa = 1 } custom_effect_tooltip = raj_upa_1 }
	raj_calculate_election = yes
}
increase_enemy_support_by_1 = {
	hidden_effect = {
		if = { limit = { RAJ = { has_country_flag = inc_operation } } add_to_variable = { inc = 1 } }
		if = { limit = { RAJ = { has_country_flag = ifb_operation } } add_to_variable = { ifb = 1 } }
		if = { limit = { RAJ = { has_country_flag = upa_operation } } add_to_variable = { upa = 1 } }
		raj_calculate_election = yes
	}
}
raj_lost_election_consequences = {
	set_political_power = 0 #A Bit punishing, but put here to stop abusers
	add_stability = -0.1
	add_war_support = -0.1
	if = {
		limit = {
			has_country_flag = INC_victory
		}
		unlock_national_focus = RAJ_Secure_Rural_Hindus
	}
	if = {
		limit = {
			has_country_flag = UP_victory
		}
		unlock_national_focus = RAJ_Content_for_British_Rule
	}
	if = {
		limit = {
			has_country_flag = ILP_victory
		}
		unlock_national_focus = RAJ_Appeal_to_the_Lower_Castes
	}
}
raj_calculate_popularity_post_election = {
	hidden_effect = {
		news_event = {
			id = india.5
			hours = 50
		}
		
		set_party_name = {
			ideology = neutrality
			name = "UP"
			long_name = "Unionist Party"
		}
		set_popularities = {
			democratic = inc_control
			neutrality = upa_control
			fascism = neutral_control
			communism = ifb_control
		}
		set_political_party = {
			ideology = fascism
			popularity = 0
		}
		clear_variable = inc_control
		clear_variable = upa_control
		clear_variable = ifb_control
		clear_variable = neutral_control
	}
}
ilp_srl_uprising = {
	custom_effect_tooltip = ilp_srl_uprising
	hidden_effect = {
		SRL = {
			transfer_state = 422
			load_oob = SRL_revolution
			declare_war_on = {
				target = ENG
				type = topple_government 
			}
			set_global_flag = sri_lankan_rebellion
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = var:RAJ.SRL_arms
				producer = RAJ
			}
			set_politics = {
				ruling_party = communism
				elections_allowed = yes
			}
			set_political_party = {
				ideology = communism
				popularity = var:RAJ.SRL_pol
			}
			set_cosmetic_tag = SRL_Revolution
			inherit_technology = RAJ
			add_offsite_building = { type = arms_factory level = 2 }
			add_ai_strategy = {
				type = alliance
				id = SOV
				value = -1000
			}
			SOV = {
				add_ai_strategy = {
					type = alliance
					id = PREV
					value = -1000
				}
			}
		}
	}
}
ilp_nep_uprising = {
	custom_effect_tooltip = ilp_nep_uprising
	hidden_effect = { 
		NEP = {
			if = {
				limit = {
					NEP = {
						is_subject = yes
					}
				}
				Overlord = {
					set_autonomy = {
						target = NEP
						autonomy_state = autonomy_free
					}
				}
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = var:RAJ.NEP_arms
				producer = RAJ
			}
			leave_faction = yes
			set_politics = {
				ruling_party = communism
				elections_allowed = yes
			}
			set_political_party = {
				ideology = communism
				popularity = var:RAJ.NEP_pol
			}
			set_global_flag = nepalese_rebellion
			add_ai_strategy = {
				type = alliance
				id = SOV
				value = -1000
			}
			SOV = {
				add_ai_strategy = {
					type = alliance
					id = PREV
					value = -1000
				}
			}
		}
	}
}
ilp_bhu_uprising = {
	custom_effect_tooltip = ilp_bhu_uprising
	hidden_effect = {
		BHU = {
			if = {
				limit = {
					BHU = {
						is_subject = yes
					}
				}
				Overlord = {
					set_autonomy = {
						target = BHU
						autonomy_state = autonomy_free
					}
				}
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = var:RAJ.BHU_arms
				producer = RAJ
			}
			leave_faction = yes
			set_politics = {
				ruling_party = communism
				elections_allowed = yes
			}
			set_political_party = {
				ideology = communism
				popularity = var:RAJ.BHU_pol
			}
			set_global_flag = bhutanese_rebellion
			add_ai_strategy = {
				type = alliance
				id = SOV
				value = -1000
			}
			SOV = {
				add_ai_strategy = {
					type = alliance
					id = PREV
					value = -1000
				}
			}
		}
	}
}
ilp_national_increase = {
	if = {
		limit = {
			has_idea = RAJ_National_Communism_2
		}
		swap_ideas = {
			remove_idea = RAJ_National_Communism_2
			add_idea = RAJ_National_Communism_3
		}
	}
	else_if = {
		limit = {
			has_idea = RAJ_National_Communism_1
		}
		swap_ideas = {
			remove_idea = RAJ_National_Communism_1 
			add_idea = RAJ_National_Communism_2
		}
	}
	else_if = {
		limit = {
			has_idea = RAJ_National_Communism_0
		}
		swap_ideas = {
			remove_idea = RAJ_National_Communism_0
			add_idea = RAJ_National_Communism_1
		}
	}
	else_if = {
		limit = { always = yes } #In the sense of preserving structure
		add_ideas = RAJ_National_Communism_0
	}
}
ilp_international_increase = {
	if = {
		limit = {
			has_idea = RAJ_International_Communism_2
		}
		swap_ideas = {
			remove_idea = RAJ_International_Communism_2
			add_idea = RAJ_International_Communism_3
		}
	}
	else_if = {
		limit = {
			has_idea = RAJ_International_Communism_1
		}
		swap_ideas = {
			remove_idea = RAJ_International_Communism_1 
			add_idea = RAJ_International_Communism_2
		}
	}
	else_if = {
		limit = {
			has_idea = RAJ_International_Communism_0
		}
		swap_ideas = {
			remove_idea = RAJ_International_Communism_0
			add_idea = RAJ_International_Communism_1
		}
	}
	else_if = {
		limit = { always = yes } #In the sense of preserving structure
		add_ideas = RAJ_International_Communism_0
	}
}
prince_independence_effect = {
	#tbd
	set_demilitarized_zone = yes
	remove_dynamic_modifier = { modifier = princely_state_mod }
	add_dynamic_modifier = { modifier = princely_state_independence_mod }
	set_state_flag = princely_state_independence
	ROOT = { 
		add_political_power = -30
	}
}
princely_state_annexation = {
	set_demilitarized_zone = no
	remove_dynamic_modifier = { modifier = princely_state_independence_mod }
	clr_state_flag = princely_state_independence
	clr_state_flag = princely_state
}
prince_integration = {
	clr_state_flag = princely_state
	remove_dynamic_modifier = { modifier = princely_state_mod }
	if = {
		limit = {
			NOT = {
				state = 787
				state = 426
				state = 434
			}
		}
		ROOT = { 
			add_political_power = 20
		}
	}
}