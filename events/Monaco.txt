###########################
# Costa Rica Events
###########################

add_namespace = monaco

# Italian Occupation
country_event = {
	id = monaco.1
	title = monaco.1.t
	desc = monaco.1.d
	picture = GFX_report_event_mco_monaco

	fire_only_once = yes
	
	trigger = {
		original_tag = MNC
		ITA = {
			controls_state = 735
			has_government = fascism
			NOT = {
				is_ally_with = MNC
			}
		}
		MNC = {
			has_war = no
		}
	}

	
	mean_time_to_happen = {
		days = 360
	}

	immediate = {
		set_variable = { MNC_democratic_popularity = MNC.party_popularity_100@democratic }
		clamp_variable = {
			var = MNC_democratic_popularity
			min = 0
			max = 100
		}
		set_variable = { MNC_communism_popularity = MNC.party_popularity_100@communism }
		clamp_variable = {
			var = MNC_communism_popularity
			min = 0
			max = 100
		}
		set_variable = { MNC_neutrality_popularity = MNC.party_popularity_100@neutrality }
		clamp_variable = {
			var = MNC_neutrality_popularity
			min = 0
			max = 100
		}
		set_variable = { MNC_fascism_popularity = MNC.party_popularity_100@fascism }
		clamp_variable = {
			var = MNC_fascism_popularity
			min = 0
			max = 100
		}
		hidden_effect = {
			set_country_flag = MNC_is_protectorate_flag
		}
		if = {
			limit = {
				has_government = democratic
			}
			set_country_flag = MNC_is_democratic_flag
		}
		if = {
			limit = {
				has_government = neutrality
			}
			set_country_flag = MNC_is_neutral_flag
		}
		if = {
			limit = {
				has_government = communism
			}
			set_country_flag = MNC_is_communistic_flag
		}
		if = {
			limit = {
				has_government = fascism
			}
			set_country_flag = MNC_is_fascist_flag
		}
	}

	option = { # historical
		name = monaco.1.a

		ai_chance = {
			base = 99 #Let's be honest, it's Monaco we're talking about here
        }

		add_stability = -0.15
		add_war_support = -0.15

		ITA = { 
			puppet = MNC 
		}

		MNC = {
			set_rule = { can_join_factions = no	}
			set_rule = { can_decline_call_to_war = yes }
			set_rule = {
	    		desc = can_access_market 
	    		can_access_market = no
			}

			if = {
				limit = {
					has_dlc = "La Resistance"
				}
				set_rule = { contributes_operatives = no	}
			}
		}

		every_state = {
			limit = {
				is_controlled_by = ITA 
				is_core_of = MNC
			}
			transfer_state_to = MNC
		}
		if = {
			limit = {
				has_wargoal_against = ITA
			}
			remove_wargoal = {
			    type = all
			    target = ITA
			}
		}

		hidden_effect = {
			set_popularities = { 
				democratic = MNC_democratic_popularity
				fascism = MNC_fascism_popularity
				communism = MNC_communism_popularity
				neutrality = MNC_neutrality_popularity
			}
			if = {
				limit = {
					MNC = {
						is_ai = yes
					}
				}
				add_ideas = MNC_reluctant_puppet
			}
			if = {
				limit = {
					has_country_flag = MNC_is_democratic_flag
				}
				set_politics = { ruling_party = democratic }
			}
			if = {
				limit = {
					has_country_flag = MNC_is_neutral_flag
				}
				set_politics = { ruling_party = neutrality }
			}
			if = {
				limit = {
					has_country_flag = MNC_is_communistic_flag
				}
				set_politics = { ruling_party = communism }
			}
			if = {
				limit = {
					has_country_flag = MNC_is_fascist_flag
				}
				set_politics = { ruling_party = fascism }
			}

			every_possible_country = {
				limit = {
					has_war_with = MNC
				}
				white_peace = MNC
			}

			news_event = {
				id = monaco.6
				days = 1
				random_hours = 12
			}

			leave_faction = yes
		}
	}

	option = { # resist
		name = monaco.1.b

		ai_chance = {
			base = 1
        }

		add_war_support = 0.15

		ITA = {
			declare_war_on = {
				target = MNC
				type = annex_everything
			}
		}
	}	
}

# Monaco becomes free from Italy
country_event = {
	id = monaco.2
	title = monaco.2.t
	desc = monaco.2.d
	picture = GFX_report_event_mco_monaco

	fire_only_once = yes
	
	trigger = {
		original_tag = MNC
		ITA = {
			NOT = {
				controls_state = 735
			}	
		}
		MNC = {
			is_subject_of = ITA
			has_country_flag = MNC_is_protectorate_flag
		}
	}

	
	mean_time_to_happen = {
		days = 1
	}

	option = { # We're free
		name = monaco.2.a

		add_war_support = 0.05

		ITA = {
			end_puppet = MNC
		}
		if = {
			limit = {
				has_idea = MNC_reluctant_puppet
			}
			remove_ideas = MNC_reluctant_puppet
		}
		MNC = {
			set_rule = { can_join_factions = yes }
			set_rule = { can_decline_call_to_war = yes }
			set_rule = {
	    		desc = can_access_market 
	    		can_access_market = yes
			}

			if = {
				limit = {
					has_dlc = "La Resistance"
				}
				set_rule = { contributes_operatives = yes }
			}
		}
	}
}

# German Invasion
country_event = {
	id = monaco.3
	title = monaco.3.t
	desc = monaco.3.d
	picture = GFX_report_event_mco_monaco

	fire_only_once = yes
	
	trigger = {
		original_tag = MNC
		GER = {
			AND = {
				controls_state = 735
				controls_state = 16
			}	
			has_government = fascism
			NOT = {
				is_ally_with = MNC
			}
		}
		MNC = {
			has_war = no
			has_country_flag = MNC_is_protectorate_flag
		}
	}

	
	mean_time_to_happen = {
		days = 2
	}

	immediate = {
		set_variable = { MNC_democratic_popularity = MNC.party_popularity_100@democratic }
		clamp_variable = {
			var = MNC_democratic_popularity
			min = 0
			max = 100
		}
		set_variable = { MNC_communism_popularity = MNC.party_popularity_100@communism }
		clamp_variable = {
			var = MNC_communism_popularity
			min = 0
			max = 100
		}
		set_variable = { MNC_neutrality_popularity = MNC.party_popularity_100@neutrality }
		clamp_variable = {
			var = MNC_neutrality_popularity
			min = 0
			max = 100
		}
		set_variable = { MNC_fascism_popularity = MNC.party_popularity_100@fascism }
		clamp_variable = {
			var = MNC_fascism_popularity
			min = 0
			max = 100
		}
		hidden_effect = {
			set_country_flag = MNC_is_protectorate_flag_GER
		}
		if = {
			limit = {
				has_government = democratic
			}
			set_country_flag = MNC_is_democratic_flag
		}
		if = {
			limit = {
				has_government = neutrality
			}
			set_country_flag = MNC_is_neutral_flag
		}
		if = {
			limit = {
				has_government = communism
			}
			set_country_flag = MNC_is_communistic_flag
		}
		if = {
			limit = {
				has_government = fascism
			}
			set_country_flag = MNC_is_fascist_flag
		}
	}

	option = { # historical
		name = monaco.3.a

		ai_chance = {
			base = 99
        }

		GER = { 
			puppet = MNC 
		}

		MNC = {
			set_rule = { can_join_factions = no	}
			set_rule = { can_decline_call_to_war = yes }
			set_rule = {
	    		desc = can_access_market 
	    		can_access_market = no
			}

			if = {
				limit = {
					has_dlc = "La Resistance"
				}
				set_rule = { contributes_operatives = no }
			}
		}

		every_state = {
			limit = {
				is_controlled_by = GER 
				is_core_of = MNC
			}
			transfer_state_to = MNC
		}
		if = {
			limit = {
				has_wargoal_against = GER
			}
			remove_wargoal = {
			    type = all
			    target = GER
			}
		}

		hidden_effect = {
			set_popularities = { 
				democratic = MNC_democratic_popularity
				fascism = MNC_fascism_popularity
				communism = MNC_communism_popularity
				neutrality = MNC_neutrality_popularity
			}
			if = {
				limit = {
					MNC = {
						is_ai = yes
					}
				}
				add_ideas = MNC_reluctant_puppet
			}
			if = {
				limit = {
					has_country_flag = MNC_is_democratic_flag
				}
				set_politics = { ruling_party = democratic }
			}
			if = {
				limit = {
					has_country_flag = MNC_is_neutral_flag
				}
				set_politics = { ruling_party = neutrality }
			}
			if = {
				limit = {
					has_country_flag = MNC_is_communistic_flag
				}
				set_politics = { ruling_party = communism }
			}
			if = {
				limit = {
					has_country_flag = MNC_is_fascist_flag
				}
				set_politics = { ruling_party = fascism }
			}
			GER = {
				country_event = { id = monaco.5 days = 1 }
			}

			leave_faction = yes

			every_possible_country = {
				limit = {
					has_war_with = MNC
				}
				white_peace = MNC
			}

			news_event = {
				id = monaco.7
				days = 1
				random_hours = 12
			}
		}
	}

	option = { # resist
		name = monaco.3.b

		ai_chance = {
			base = 1
        }

		add_war_support = 0.15

		GER = {
			declare_war_on = {
				target = MNC
				type = annex_everything
			}
		}
	}	
}

# Monaco Breaks Free from Germany
country_event = {
	id = monaco.4
	title = monaco.4.t
	desc = monaco.4.d
	picture = GFX_report_event_mco_monaco

	fire_only_once = yes
	
	trigger = {
		original_tag = MNC
		GER = {
			NOT = {
				controls_state = 735
				controls_state = 16
			}
		}
		MNC = {
			is_subject_of = GER
			has_country_flag = MNC_is_protectorate_flag_GER
		}
	}

	
	mean_time_to_happen = {
		days = 1
	}

	option = { # We're free...again
		name = monaco.4.a

		add_war_support = 0.05

		GER = {
			end_puppet = MNC
		}
		if = {
			limit = {
				has_idea = MNC_reluctant_puppet
			}
			remove_ideas = MNC_reluctant_puppet
		}
		MNC = {
			set_rule = { can_join_factions = yes }
			set_rule = { can_decline_call_to_war = yes }
			set_rule = {
	    		desc = can_access_market 
	    		can_access_market = yes
			}

			if = {
				limit = {
					has_dlc = "La Resistance"
				}
				set_rule = { contributes_operatives = yes }
			}
			add_popularity = {
				ideology = communism
				popularity = 0.2
			}
			add_popularity = {
				ideology = democratic
				popularity = 0.2
			}
		}
	}
}

# Occupier Event
country_event = {
	id = monaco.5
	title = monaco.5.t
	desc = monaco.5.d
	picture = GFX_report_event_mco_monaco

	is_triggered_only = yes

	option = { # Excellent
		name = monaco.5.a

		add_political_power = 10
	}
}

# Monaguesque Occupation by Italy
news_event = {
	id = monaco.6
	title = monaco.6.t
	desc = monaco.6.d
	picture = GFX_news_event_mnc_monaco
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		name = monaco.6.a
	}
}

# Monaguesque Occupation by Germany
news_event = {
	id = monaco.7
	title = monaco.7.t
	desc = monaco.7.d
	picture = GFX_news_event_mnc_monaco
	
	major = yes
	
	is_triggered_only = yes
	
	option = {
		name = monaco.6.a
	}
}
